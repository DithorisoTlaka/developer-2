<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lumina — Your Learning Space</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">

  <link href="https://cdn.jsdelivr.net/npm/remixicon@4.3.0/fonts/remixicon.css" rel="stylesheet"/>

  <style>
    :root {
      --bg:          #0a0e17;
      --surface:     #11151f;
      --text:        #e5e7eb;
      --text-muted:  #9ca3af;
      --border:      #1f2937;
      --primary:     #6366f1;
      --primary-dark:#4f46e5;
      --glow:        rgba(99, 102, 241, 0.18);
      --error:       #f87171;
      --success:     #34d399;
    }

    * { margin:0; padding:0; box-sizing:border-box; }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
    }

    /* ── AUTH PAGE ─────────────────────────────────────── */
    #authPage {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      padding: 1.5rem;
    }

    .auth-container {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 2.5rem 2rem;
      width: 100%;
      max-width: 420px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.4);
    }

    .logo {
      font-size: 2.4rem;
      font-weight: 600;
      letter-spacing: -0.04em;
      text-align: center;
      margin-bottom: 0.5rem;
      color: white;
    }

    .subtitle {
      text-align: center;
      color: var(--text-muted);
      font-size: 0.95rem;
      margin-bottom: 2.2rem;
    }

    .tabs {
      display: flex;
      margin-bottom: 1.8rem;
      border-bottom: 1px solid var(--border);
    }

    .tab {
      flex: 1;
      background: none;
      border: none;
      padding: 0.9rem 0;
      font-size: 0.97rem;
      color: var(--text-muted);
      cursor: pointer;
      font-weight: 500;
      transition: color 0.2s;
      position: relative;
    }

    .tab.active {
      color: white;
    }

    .tab.active::after {
      content: '';
      position: absolute;
      bottom: -1px;
      left: 0;
      right: 0;
      height: 2px;
      background: var(--primary);
    }

    .form-field {
      margin-bottom: 1.4rem;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      color: var(--text-muted);
      font-size: 0.9rem;
      font-weight: 500;
    }

    input {
      width: 100%;
      padding: 0.9rem 1.1rem;
      background: #0f1622;
      border: 1px solid var(--border);
      border-radius: 8px;
      color: white;
      font-size: 0.97rem;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px var(--glow);
    }

    .btn {
      width: 100%;
      padding: 1rem;
      margin: 0.6rem 0;
      border: none;
      border-radius: 8px;
      font-size: 0.97rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }

    .btn-primary:hover {
      background: var(--primary-dark);
    }

    .btn-google {
      background: #ffffff;
      color: #111827;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.7rem;
    }

    .btn-google:hover {
      background: #f3f4f6;
    }

    .divider {
      display: flex;
      align-items: center;
      text-align: center;
      margin: 1.6rem 0;
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    .divider::before,
    .divider::after {
      content: '';
      flex: 1;
      border-bottom: 1px solid var(--border);
    }

    .divider span {
      padding: 0 1.2rem;
    }

    .toggle {
      text-align: center;
      margin-top: 1.2rem;
      color: var(--text-muted);
      font-size: 0.92rem;
    }

    .toggle a {
      color: var(--primary);
      text-decoration: none;
      font-weight: 500;
    }

    .toggle a:hover {
      text-decoration: underline;
    }

    .error-msg {
      color: var(--error);
      font-size: 0.85rem;
      margin: 0.8rem 0;
      text-align: center;
    }

    /* ── DASHBOARD ─────────────────────────────────────── */
    #dashboard {
      display: none;
    }

    .dashboard-wrapper {
      display: flex;
      min-height: 100vh;
    }

    .sidebar-left {
      width: 260px;
      background: var(--surface);
      border-right: 1px solid var(--border);
      position: fixed;
      top: 0;
      bottom: 0;
      overflow-y: auto;
    }

    .sidebar-content {
      padding: 5rem 0 2rem;
    }

    .tab-link {
      display: block;
      padding: 1rem 1.8rem;
      color: var(--text-muted);
      text-decoration: none;
      font-weight: 500;
      transition: all 0.2s;
    }

    .tab-link:hover,
    .tab-link.active {
      background: rgba(99,102,241,0.12);
      color: white;
    }

    .main-view {
      margin-left: 260px;
      flex: 1;
      padding: 2.5rem;
    }

    .dashboard-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2.5rem;
      padding-bottom: 1.5rem;
      border-bottom: 1px solid var(--border);
    }

    .welcome {
      font-size: 1.9rem;
      font-weight: 600;
    }

    .card {
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 1.8rem;
      margin-bottom: 2rem;
    }

    .card h2 {
      margin-bottom: 1rem;
      color: var(--primary);
    }

    @media (max-width: 900px) {
      .sidebar-left { width: 220px; }
      .main-view { margin-left: 220px; padding: 1.5rem; }
    }
  </style>
</head>
<body>

  <!-- ── AUTHENTICATION PAGE ─────────────────────────────────────── -->
  <div id="authPage">
    <div class="auth-container">
      <div class="logo">Lumina</div>
      <div class="subtitle">Your learning space</div>

      <div class="tabs">
        <button class="tab active" onclick="switchMode('login')">Sign in</button>
        <button class="tab" onclick="switchMode('signup')">Create account</button>
      </div>

      <div id="errorMessage" class="error-msg"></div>

      <!-- Sign In Form -->
      <form id="loginForm">
        <div class="form-field">
          <label for="loginEmail">Email</label>
          <input type="email" id="loginEmail" placeholder="you@example.com" required autocomplete="email" />
        </div>
        <div class="form-field">
          <label for="loginPassword">Password</label>
          <input type="password" id="loginPassword" placeholder="••••••••" required autocomplete="current-password" />
        </div>

        <button type="submit" class="btn btn-primary">Sign in</button>

        <div class="divider"><span>or</span></div>

        <button type="button" class="btn btn-google" onclick="signInWithGoogle()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M22.56 12.25C22.56 11.47 22.49 10.69 22.36 10H12V14.51H18.2C17.95 15.99 17.05 17.23 15.79 18.09V21.09H19.33C21.49 19.09 22.56 15.92 22.56 12.25Z" fill="#4285F4"/>
            <path d="M12 23C14.97 23 17.46 22 19.33 20.09L15.79 18.09C14.79 18.81 13.49 19.25 12 19.25C9.07 19.25 6.57 17.22 5.68 14.47H2.06V17.6C3.98 20.92 7.78 23 12 23Z" fill="#34A853"/>
            <path d="M5.68 14.47C5.25 13.17 5 11.61 5 10C5 8.39 5.25 6.83 5.68 5.53V2.4H2.06C0.72 5.09 0 8 0 11C0 13.99 0.72 16.91 2.06 19.6L5.68 14.47Z" fill="#FBBC05"/>
            <path d="M12 4.98C13.64 4.98 15.11 5.54 16.27 6.64L19.46 3.45C17.46 1.59 14.97 0.5 12 0.5C7.78 0.5 3.98 2.58 2.06 5.9L5.68 10C6.57 7.25 9.07 5.22 12 5.22V4.98Z" fill="#EA4335"/>
          </svg>
          Continue with Google
        </button>
      </form>

      <!-- Sign Up Form -->
      <form id="signupForm" style="display:none;">
        <div class="form-field">
          <label for="signupEmail">Email</label>
          <input type="email" id="signupEmail" placeholder="you@example.com" required autocomplete="email" />
        </div>
        <div class="form-field">
          <label for="signupPassword">Password</label>
          <input type="password" id="signupPassword" placeholder="••••••••" required minlength="6" autocomplete="new-password" />
        </div>
        <div class="form-field">
          <label for="signupConfirm">Confirm Password</label>
          <input type="password" id="signupConfirm" placeholder="••••••••" required minlength="6" autocomplete="new-password" />
        </div>

        <button type="submit" class="btn btn-primary">Create account</button>

        <div class="divider"><span>or</span></div>

        <button type="button" class="btn btn-google" onclick="signInWithGoogle()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M22.56 12.25C22.56 11.47 22.49 10.69 22.36 10H12V14.51H18.2C17.95 15.99 17.05 17.23 15.79 18.09V21.09H19.33C21.49 19.09 22.56 15.92 22.56 12.25Z" fill="#4285F4"/>
            <path d="M12 23C14.97 23 17.46 22 19.33 20.09L15.79 18.09C14.79 18.81 13.49 19.25 12 19.25C9.07 19.25 6.57 17.22 5.68 14.47H2.06V17.6C3.98 20.92 7.78 23 12 23Z" fill="#34A853"/>
            <path d="M5.68 14.47C5.25 13.17 5 11.61 5 10C5 8.39 5.25 6.83 5.68 5.53V2.4H2.06C0.72 5.09 0 8 0 11C0 13.99 0.72 16.91 2.06 19.6L5.68 14.47Z" fill="#FBBC05"/>
            <path d="M12 4.98C13.64 4.98 15.11 5.54 16.27 6.64L19.46 3.45C17.46 1.59 14.97 0.5 12 0.5C7.78 0.5 3.98 2.58 2.06 5.9L5.68 10C6.57 7.25 9.07 5.22 12 5.22V4.98Z" fill="#EA4335"/>
          </svg>
          Continue with Google
        </button>
      </form>

      <div class="toggle" id="toggleSignup">
        Don't have an account? <a href="#" onclick="switchMode('signup'); return false;">Sign up</a>
      </div>
      <div class="toggle" id="toggleLogin" style="display:none;">
        Already have an account? <a href="#" onclick="switchMode('login'); return false;">Sign in</a>
      </div>
    </div>
  </div>

  <!-- ── LEARNER DASHBOARD ───────────────────────────────────────── -->
  <div id="dashboard">
    <div class="dashboard-wrapper">
      <!-- Sidebar -->
      <aside class="sidebar-left">
        <div class="sidebar-content">
          <a href="#" class="tab-link active" data-tab="overview" onclick="showTab(event, 'overview')">Overview</a>
          <a href="#" class="tab-link" data-tab="assignments" onclick="showTab(event, 'assignments')">Assignments</a>
          <a href="#" class="tab-link" data-tab="materials" onclick="showTab(event, 'materials')">Materials</a>
          <a href="#" class="tab-link" data-tab="timetable" onclick="showTab(event, 'timetable')">Timetable</a>
          <a href="#" class="tab-link" data-tab="chat" onclick="showTab(event, 'chat')">Lecturer Chat</a>
        </div>
      </aside>

      <!-- Main Content -->
      <main class="main-view">
        <div class="dashboard-header">
          <div class="welcome">Welcome back, <span id="userDisplayName">Learner</span></div>
          <button class="btn btn-primary" onclick="signOutUser()">Sign Out</button>
        </div>

        <!-- Tab Contents -->
        <div id="overview" class="tab-content active">
          <div class="card">
            <h2>Dashboard Overview</h2>
            <p>Quick summary of your progress, upcoming deadlines, and recent activity.</p>
          </div>
        </div>

        <div id="assignments" class="tab-content" style="display:none;">
          <div class="card">
            <h2>Assignments</h2>
            <p>Your current assignments and submission status will appear here.</p>
          </div>
        </div>

        <div id="materials" class="tab-content" style="display:none;">
          <div class="card">
            <h2>Learning Materials</h2>
            <p>Notes, videos, past papers and study guides.</p>
          </div>
        </div>

        <div id="timetable" class="tab-content" style="display:none;">
          <div class="card">
            <h2>Timetable & Exams</h2>
            <p>Your class and exam schedule.</p>
          </div>
        </div>

        <div id="chat" class="tab-content" style="display:none;">
          <div class="card">
            <h2>Lecturer Chat</h2>
            <p>Send messages to your lecturers.</p>
          </div>
        </div>
      </main>
    </div>
  </div>

  <!-- Firebase & Auth Logic -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-app.js";
    import {
      getAuth,
      GoogleAuthProvider,
      signInWithPopup,
      signInWithEmailAndPassword,
      createUserWithEmailAndPassword,
      onAuthStateChanged,
      signOut
    } from "https://www.gstatic.com/firebasejs/10.14.1/firebase-auth.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDLvkRwSpd-hbPaDP31pV1H-4N5_Re-_xc",
      authDomain: "learnermanagementsystem-f3b6a.firebaseapp.com",
      projectId: "learnermanagementsystem-f3b6a",
      storageBucket: "learnermanagementsystem-f3b6a.firebasestorage.app",
      messagingSenderId: "173549259244",
      appId: "1:173549259244:web:f8722018a989c484a7d8c9",
      measurementId: "G-K1VW244B7P"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const googleProvider = new GoogleAuthProvider();

    // ── Show / Hide Pages ────────────────────────────────────
    function showAuth() {
      document.getElementById('authPage').style.display = 'flex';
      document.getElementById('dashboard').style.display = 'none';
    }

    function showDashboard(user) {
      document.getElementById('authPage').style.display = 'none';
      document.getElementById('dashboard').style.display = 'block';

      const name = user.displayName || user.email?.split('@')[0] || 'Learner';
      document.getElementById('userDisplayName').textContent = name;
    }

    onAuthStateChanged(auth, (user) => {
      if (user) {
        showDashboard(user);
      } else {
        showAuth();
      }
    });

    // ── Tab Navigation ───────────────────────────────────────
    function showTab(e, tabId) {
      e.preventDefault();
      document.querySelectorAll('.tab-content').forEach(el => el.style.display = 'none');
      document.querySelectorAll('.tab-link').forEach(el => el.classList.remove('active'));

      document.getElementById(tabId).style.display = 'block';
      e.currentTarget.classList.add('active');
    }

    // ── Form Handlers ────────────────────────────────────────
    document.getElementById('loginForm').addEventListener('submit', async e => {
      e.preventDefault();
      const email = document.getElementById('loginEmail').value.trim();
      const password = document.getElementById('loginPassword').value;
      const errorEl = document.getElementById('errorMessage');

      errorEl.textContent = '';

      try {
        await signInWithEmailAndPassword(auth, email, password);
      } catch (err) {
        errorEl.textContent = err.code === 'auth/wrong-password' ? 'Incorrect password'
                            : err.code === 'auth/user-not-found' ? 'No account found with this email'
                            : 'Login failed. Please try again.';
      }
    });

    document.getElementById('signupForm').addEventListener('submit', async e => {
      e.preventDefault();
      const email = document.getElementById('signupEmail').value.trim();
      const password = document.getElementById('signupPassword').value;
      const confirm = document.getElementById('signupConfirm').value;
      const errorEl = document.getElementById('errorMessage');

      errorEl.textContent = '';

      if (password !== confirm) {
        errorEl.textContent = 'Passwords do not match';
        return;
      }

      if (password.length < 6) {
        errorEl.textContent = 'Password must be at least 6 characters';
        return;
      }

      try {
        await createUserWithEmailAndPassword(auth, email, password);
      } catch (err) {
        errorEl.textContent = err.code === 'auth/email-already-in-use' ? 'This email is already registered'
                            : err.code === 'auth/weak-password' ? 'Password is too weak'
                            : 'Sign up failed. Please try again.';
      }
    });

    window.signInWithGoogle = async () => {
      try {
        await signInWithPopup(auth, googleProvider);
      } catch (err) {
        document.getElementById('errorMessage').textContent = 'Google sign-in failed';
      }
    };

    window.signOutUser = () => {
      signOut(auth);
    };

    // ── Switch between login & signup ────────────────────────
    window.switchMode = function(mode) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.getElementById('errorMessage').textContent = '';

      if (mode === 'login') {
        document.getElementById('loginForm').style.display = 'block';
        document.getElementById('signupForm').style.display = 'none';
        document.querySelector('.tab:first-child').classList.add('active');
        document.getElementById('toggleSignup').style.display = 'block';
        document.getElementById('toggleLogin').style.display = 'none';
      } else {
        document.getElementById('loginForm').style.display = 'none';
        document.getElementById('signupForm').style.display = 'block';
        document.querySelector('.tab:last-child').classList.add('active');
        document.getElementById('toggleSignup').style.display = 'none';
        document.getElementById('toggleLogin').style.display = 'block';
      }
    };
  </script>
</body>
</html>
